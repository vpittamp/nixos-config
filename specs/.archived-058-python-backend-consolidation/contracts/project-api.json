{
  "api": "Project Management",
  "version": "1.0",
  "protocol": "JSON-RPC 2.0",
  "description": "Project CRUD operations and active project state management",
  "methods": [
    {
      "name": "project_create",
      "description": "Create a new project",
      "params": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "required": true,
            "description": "Unique project identifier",
            "pattern": "^[a-zA-Z0-9_-]+$"
          },
          "directory": {
            "type": "string",
            "required": true,
            "description": "Absolute path to project directory"
          },
          "display_name": {
            "type": "string",
            "required": true,
            "description": "Human-readable project name"
          },
          "icon": {
            "type": "string",
            "required": false,
            "description": "Project icon (emoji or text, defaults to üìÅ)"
          }
        }
      },
      "result": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "directory": {
            "type": "string"
          },
          "display_name": {
            "type": "string"
          },
          "icon": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "errors": [
        {
          "code": -32602,
          "message": "Invalid params",
          "description": "Missing or invalid parameters"
        },
        {
          "code": 1003,
          "message": "Validation error",
          "description": "Directory does not exist or is not absolute path",
          "data": {
            "field": "string",
            "reason": "string"
          }
        },
        {
          "code": 1004,
          "message": "File I/O error",
          "description": "Project already exists or cannot write file",
          "data": {
            "path": "string"
          }
        }
      ],
      "example_request": {
        "jsonrpc": "2.0",
        "method": "project_create",
        "params": {
          "name": "nixos",
          "directory": "/etc/nixos",
          "display_name": "NixOS Configuration",
          "icon": "‚ùÑÔ∏è"
        },
        "id": 1
      },
      "example_response": {
        "jsonrpc": "2.0",
        "result": {
          "name": "nixos",
          "directory": "/etc/nixos",
          "display_name": "NixOS Configuration",
          "icon": "‚ùÑÔ∏è",
          "created_at": "2025-11-03T14:30:00",
          "updated_at": "2025-11-03T14:30:00"
        },
        "id": 1
      }
    },
    {
      "name": "project_list",
      "description": "List all projects",
      "params": {
        "type": "object",
        "properties": {}
      },
      "result": {
        "type": "object",
        "properties": {
          "projects": {
            "type": "array",
            "description": "List of all projects (sorted by name)",
            "items": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string"
                },
                "directory": {
                  "type": "string"
                },
                "display_name": {
                  "type": "string"
                },
                "icon": {
                  "type": "string"
                },
                "created_at": {
                  "type": "string",
                  "format": "date-time"
                },
                "updated_at": {
                  "type": "string",
                  "format": "date-time"
                }
              }
            }
          }
        }
      },
      "errors": [],
      "example_request": {
        "jsonrpc": "2.0",
        "method": "project_list",
        "params": {},
        "id": 2
      },
      "example_response": {
        "jsonrpc": "2.0",
        "result": {
          "projects": [
            {
              "name": "nixos",
              "directory": "/etc/nixos",
              "display_name": "NixOS Configuration",
              "icon": "‚ùÑÔ∏è",
              "created_at": "2025-11-01T10:00:00",
              "updated_at": "2025-11-03T14:30:00"
            },
            {
              "name": "stacks",
              "directory": "/home/user/projects/stacks",
              "display_name": "Stacks Platform",
              "icon": "üöÄ",
              "created_at": "2025-11-02T12:00:00",
              "updated_at": "2025-11-02T12:00:00"
            }
          ]
        },
        "id": 2
      }
    },
    {
      "name": "project_get",
      "description": "Get details for a specific project",
      "params": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "required": true,
            "description": "Project name"
          }
        }
      },
      "result": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "directory": {
            "type": "string"
          },
          "display_name": {
            "type": "string"
          },
          "icon": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "errors": [
        {
          "code": 1001,
          "message": "Project not found",
          "data": {
            "name": "string"
          }
        }
      ],
      "example_request": {
        "jsonrpc": "2.0",
        "method": "project_get",
        "params": {
          "name": "nixos"
        },
        "id": 3
      },
      "example_response": {
        "jsonrpc": "2.0",
        "result": {
          "name": "nixos",
          "directory": "/etc/nixos",
          "display_name": "NixOS Configuration",
          "icon": "‚ùÑÔ∏è",
          "created_at": "2025-11-01T10:00:00",
          "updated_at": "2025-11-03T14:30:00"
        },
        "id": 3
      }
    },
    {
      "name": "project_update",
      "description": "Update project metadata",
      "params": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "required": true,
            "description": "Project to update"
          },
          "directory": {
            "type": "string",
            "required": false,
            "description": "New directory path"
          },
          "display_name": {
            "type": "string",
            "required": false,
            "description": "New display name"
          },
          "icon": {
            "type": "string",
            "required": false,
            "description": "New icon"
          }
        }
      },
      "result": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "directory": {
            "type": "string"
          },
          "display_name": {
            "type": "string"
          },
          "icon": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp when project was updated"
          }
        }
      },
      "errors": [
        {
          "code": 1001,
          "message": "Project not found"
        },
        {
          "code": 1003,
          "message": "Validation error",
          "description": "New directory does not exist"
        }
      ],
      "example_request": {
        "jsonrpc": "2.0",
        "method": "project_update",
        "params": {
          "name": "nixos",
          "display_name": "NixOS System Configuration",
          "icon": "üêß"
        },
        "id": 4
      },
      "example_response": {
        "jsonrpc": "2.0",
        "result": {
          "name": "nixos",
          "directory": "/etc/nixos",
          "display_name": "NixOS System Configuration",
          "icon": "üêß",
          "created_at": "2025-11-01T10:00:00",
          "updated_at": "2025-11-03T15:00:00"
        },
        "id": 4
      }
    },
    {
      "name": "project_delete",
      "description": "Delete a project",
      "params": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "required": true,
            "description": "Project to delete"
          }
        }
      },
      "result": {
        "type": "object",
        "properties": {
          "deleted": {
            "type": "boolean",
            "description": "Whether project was deleted"
          },
          "name": {
            "type": "string"
          }
        }
      },
      "errors": [
        {
          "code": 1001,
          "message": "Project not found"
        }
      ],
      "example_request": {
        "jsonrpc": "2.0",
        "method": "project_delete",
        "params": {
          "name": "old-project"
        },
        "id": 5
      },
      "example_response": {
        "jsonrpc": "2.0",
        "result": {
          "deleted": true,
          "name": "old-project"
        },
        "id": 5
      }
    },
    {
      "name": "project_get_active",
      "description": "Get currently active project",
      "params": {
        "type": "object",
        "properties": {}
      },
      "result": {
        "type": "object",
        "properties": {
          "name": {
            "type": ["string", "null"],
            "description": "Active project name (null if in global mode)"
          }
        }
      },
      "errors": [],
      "example_request": {
        "jsonrpc": "2.0",
        "method": "project_get_active",
        "params": {},
        "id": 6
      },
      "example_response_active": {
        "jsonrpc": "2.0",
        "result": {
          "name": "nixos"
        },
        "id": 6
      },
      "example_response_global": {
        "jsonrpc": "2.0",
        "result": {
          "name": null
        },
        "id": 6
      }
    },
    {
      "name": "project_set_active",
      "description": "Set active project (triggers window filtering)",
      "params": {
        "type": "object",
        "properties": {
          "name": {
            "type": ["string", "null"],
            "required": true,
            "description": "Project to activate (null for global mode)"
          }
        }
      },
      "result": {
        "type": "object",
        "properties": {
          "previous": {
            "type": ["string", "null"],
            "description": "Previously active project name"
          },
          "current": {
            "type": ["string", "null"],
            "description": "Now active project name"
          },
          "filtering_applied": {
            "type": "boolean",
            "description": "Whether window filtering was triggered"
          }
        }
      },
      "errors": [
        {
          "code": 1001,
          "message": "Project not found",
          "description": "Cannot activate non-existent project"
        }
      ],
      "example_request_switch": {
        "jsonrpc": "2.0",
        "method": "project_set_active",
        "params": {
          "name": "nixos"
        },
        "id": 7
      },
      "example_response_switch": {
        "jsonrpc": "2.0",
        "result": {
          "previous": "stacks",
          "current": "nixos",
          "filtering_applied": true
        },
        "id": 7
      },
      "example_request_clear": {
        "jsonrpc": "2.0",
        "method": "project_set_active",
        "params": {
          "name": null
        },
        "id": 8
      },
      "example_response_clear": {
        "jsonrpc": "2.0",
        "result": {
          "previous": "nixos",
          "current": null,
          "filtering_applied": true
        },
        "id": 8
      }
    }
  ],
  "error_codes": {
    "-32700": "Parse error - Invalid JSON",
    "-32600": "Invalid Request - Not valid JSON-RPC 2.0",
    "-32601": "Method not found",
    "-32602": "Invalid params",
    "-32603": "Internal error",
    "1001": "Project not found",
    "1003": "Validation error",
    "1004": "File I/O error"
  },
  "notes": [
    "Project names must be alphanumeric with dashes/underscores only",
    "Project directories must be absolute paths and must exist",
    "Setting active project to null clears active project (global mode)",
    "project_set_active automatically triggers window filtering via Feature 037"
  ]
}
